<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Determinantes Tridiagonales y Criterio de Stolz</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root {
            --color-primary: #0d9488;
            --color-bg: #fdf6e3;
            --color-accent: #065f46;
            --color-yellow: #fef9c3;
            --color-text: #1e293b;
            --color-blue: #2563eb;
            --color-step-normal: #334155;
            --color-step-new: #1e40af;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #fdf6e3 0%, #f8fafc 100%);
            color: var(--color-text);
            line-height: 1.6;
            padding: 0;
            margin: 0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .header {
            background: linear-gradient(90deg, var(--color-primary), var(--color-accent));
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            max-width: 1800px;
            margin: 1.2rem auto;
            padding: 0 1rem;
            gap: 1.8rem;
            height: calc(100vh - 180px);
        }

        .column {
            flex: 1;
            min-width: 350px;
            background: white;
            border-radius: 18px;
            box-shadow: 0 12px 30px rgba(0,0,0,0.12);
            overflow: hidden;
            border: 2px solid #e2e8f0;
            display: flex;
            flex-direction: column;
        }

        .column-header {
            background: linear-gradient(to right, var(--color-primary), #0d7a70);
            color: white;
            padding: 1.4rem;
            font-size: 1.5rem;
            font-weight: 600;
            text-align: center;
            flex-shrink: 0;
        }

        /* CONTENEDOR DE SCROLL CON BARRAS SIEMPRE VISIBLES */
        .steps-wrapper {
            flex-grow: 1;
            overflow: scroll; /* Esto fuerza BARRAS DE DESPLAZAMIENTO HORIZONTALES Y VERTICALES */
            padding: 0 1rem 1rem 1rem;
            margin-right: -17px; /* Compensar el ancho de la barra de desplazamiento vertical */
            margin-bottom: -17px; /* Compensar la barra horizontal */
        }

        .steps-container {
            padding: 1.8rem 0.5rem 0 1.3rem;
            min-height: 100%;
            /* Asegurar que el contenido pueda desbordarse horizontalmente */
            white-space: normal;
        }

        /* Estilos para las barras de desplazamiento */
        .steps-wrapper::-webkit-scrollbar {
            width: 16px;
            height: 16px;
        }

        .steps-wrapper::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 8px;
            border: 2px solid #e2e8f0;
        }

        .steps-wrapper::-webkit-scrollbar-thumb {
            background-color: #94a3b8;
            background-clip: padding-box;
            border: 4px solid transparent;
            border-radius: 10px;
            min-height: 40px;
            min-width: 40px;
        }

        .steps-wrapper::-webkit-scrollbar-thumb:hover {
            background-color: #64748b;
        }

        .step {
            margin-bottom: 2rem;
            padding: 1.4rem;
            border-radius: 14px;
            border-left: 4px solid #cbd5e1;
            background: #f8fafc;
            position: relative;
            transition: all 0.4s ease;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            /* Permitir que el contenido se desborde horizontalmente */
            overflow-x: visible;
        }

        .step.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .step-title {
            font-weight: 700;
            color: var(--color-accent);
            margin-bottom: 1rem;
            font-size: 1.4rem;
        }

        .step-content p {
            margin: 0.9rem 0;
            line-height: 1.7;
            font-size: 1.05rem;
            /* Permitir saltos de línea en fórmulas largas */
            word-break: break-word;
        }

        .math-block {
            margin: 1.4rem 0;
            padding: 1.2rem;
            background: white;
            border-radius: 10px;
            border-left: 4px solid var(--color-primary);
            text-align: center;
            overflow-x: auto; /* Scroll horizontal para fórmulas muy anchas */
            box-shadow: 0 3px 6px rgba(0,0,0,0.06);
            font-size: 1.2rem;
            min-width: fit-content;
            display: inline-block;
        }

        .conclusion-box {
            display: inline-block;
            background: white;
            padding: 1.2rem 2.2rem;
            border-radius: 10px;
            border: 2px solid var(--color-accent);
            font-weight: bold;
            font-size: 1.4rem;
            margin: 1.2rem 0;
        }

        .mybox {
            border-left: 4px solid var(--color-primary);
            background: rgba(0,128,128,0.05);
            padding: 1.10rem 1.12rem;
            margin: 1.01rem 0;
            border-radius: 0.5rem;
            font-size: 1.01em;
            border: 1px solid rgba(0,128,128,0.2);
            background: #f0fdfa;
            overflow-x: auto;
        }

        .mybox h4 {
            margin-top: 0;
            color: var(--color-primary);
            border-bottom: 1px solid rgba(0,128,128,0.2);
            padding-bottom: 0.5rem;
            font-size: 1.2rem;
        }

        .highlight-blue {
            color: var(--color-blue) !important;
            border-left-color: var(--color-blue) !important;
            background-color: #dbeafe !important;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.15) !important;
        }

        .zoom-btn {
            position: absolute;
            top: 1.2rem;
            right: 1.2rem;
            background: rgba(255,255,255,0.85);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            color: var(--color-primary);
            box-shadow: 0 3px 8px rgba(0,0,0,0.15);
            transition: all 0.25s;
            font-weight: bold;
        }

        .zoom-btn:hover {
            background: white;
            transform: scale(1.15);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        /* Zoom overlay */
        #zoom-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.88);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }

        #zoom-overlay.active {
            display: flex;
            opacity: 1;
        }

        .zoom-content {
            background: white;
            border-radius: 20px;
            width: 92%;
            max-width: 1100px;
            max-height: 90vh;
            overflow: auto;
            box-shadow: 0 25px 60px rgba(0,0,0,0.4);
            position: relative;
        }

        .zoom-header {
            background: linear-gradient(90deg, var(--color-primary), var(--color-accent));
            color: white;
            padding: 1.4rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.4rem;
        }

        .close-zoom {
            background: rgba(255,255,255,0.25);
            border: none;
            width: 42px;
            height: 42px;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .zoom-body {
            padding: 2.5rem;
        }

        @media (max-width: 900px) {
            .container {
                flex-direction: column;
                height: auto;
                min-height: calc(100vh - 180px);
            }
            .column {
                min-width: 100%;
            }
            .header h1 {
                font-size: 2.2rem;
            }
            .steps-wrapper {
                margin-right: 0;
                margin-bottom: 0;
                padding: 0 1rem 1rem 1rem;
            }
            .steps-container {
                padding: 1.8rem;
            }
            .steps-wrapper::-webkit-scrollbar {
                width: 12px;
                height: 12px;
            }
        }

        /* Animation for new steps */
        @keyframes flashBlue {
            0% { color: var(--color-blue); border-left-color: var(--color-blue); background-color: #dbeafe; }
            70% { color: var(--color-blue); border-left-color: var(--color-blue); background-color: #dbeafe; }
            100% { color: var(--color-text); border-left-color: #cbd5e1; background-color: #f8fafc; }
        }

        .step.new {
            animation: flashBlue 3s forwards;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Determinantes tridiagonales y criterio de Stolz</h1>
    </div>

    <div class="container">
        <div class="column">
            <div class="column-header">Pasos 1-4</div>
            <div class="steps-wrapper">
                <div class="steps-container" id="left-column">
                    <!-- Steps will be populated by JS -->
                </div>
            </div>
        </div>
        <div class="column">
            <div class="column-header">Pasos 5-7</div>
            <div class="steps-wrapper">
                <div class="steps-container" id="right-column">
                    <!-- Steps will be populated by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Zoom overlay -->
    <div id="zoom-overlay">
        <div class="zoom-content">
            <div class="zoom-header">
                <h2 id="zoom-title">Paso ampliado</h2>
                <button class="close-zoom" id="close-zoom">&times;</button>
            </div>
            <div class="zoom-body" id="zoom-body">
                <!-- Zoom content will be populated by JS -->
            </div>
        </div>
    </div>

    <script>
        // Steps data
        const steps = [
            {
                id: 0,
                title: "EJERCICIO",
                content: [
                    { type: 'text', value: "Sea \\(D_n\\) el determinante de orden \\(n\\) definido por la matriz tridiagonal" },
                    { 
                        type: 'math', 
                        value: "D_n=\\begin{vmatrix} 2 & 1 & 0 & \\cdots & 0 & 0\\\\ 1 & 2 & 1 & \\cdots & 0 & 0\\\\ 0 & 1 & 2 & \\ddots & \\vdots & \\vdots\\\\ \\vdots & \\vdots & \\ddots & \\ddots & 1 & 0\\\\ 0 & 0 & \\cdots & 1 & 2 & 1\\\\ 0 & 0 & \\cdots & 0 & 1 & 2 \\end{vmatrix}." 
                    },
                    { type: 'text', value: "Calcular" },
                    { 
                        type: 'math', 
                        value: "\\lim_{n\\to\\infty}\\frac{D_1^2+D_2^2+\\cdots +D_n^2}{n^3}." 
                    }
                ]
            },
            {
                id: 1,
                title: "Cálculo de \\(D_1,D_2,D_3\\)",
                content: [
                    { type: 'text', value: "Para \\(n=1\\):" },
                    { 
                        type: 'math', 
                        value: "D_1=\\begin{vmatrix} 2 \\end{vmatrix}=2." 
                    },
                    { type: 'text', value: "Para \\(n=2\\):" },
                    { 
                        type: 'math', 
                        value: "D_2=\\begin{vmatrix} 2 & 1\\\\[2pt] 1 & 2 \\end{vmatrix}=2\\cdot 2-1\\cdot 1=3." 
                    },
                    { type: 'text', value: "Para \\(n=3\\):" },
                    { 
                        type: 'math', 
                        value: "D_3=\\begin{vmatrix} 2 & 1 & 0\\\\[2pt] 1 & 2 & 1\\\\[2pt] 0 & 1 & 2 \\end{vmatrix}." 
                    },
                    { type: 'text', value: "Desarrollando por la primera fila:" },
                    { 
                        type: 'math', 
                        value: "D_3=2\\begin{vmatrix} 2 & 1\\\\[2pt] 1 & 2 \\end{vmatrix}-1\\begin{vmatrix} 1 & 1\\\\[2pt] 0 & 2 \\end{vmatrix}=2(4-1)-(2-0)=6-2=4." 
                    },
                    { type: 'text', value: "Estos valores" },
                    { 
                        type: 'math', 
                        value: "D_1=2,\\quad D_2=3,\\quad D_3=4" 
                    },
                    { type: 'text', value: "sugieren la conjetura" },
                    { 
                        type: 'math', 
                        value: "D_n=n+1." 
                    }
                ]
            },
            {
                id: 2,
                title: "Relación de recurrencia para \\(D_n\\)",
                content: [
                    { type: 'text', value: "Tomemos \\(D_n\\) y desarrollemos por la primera fila:" },
                    { 
                        type: 'math', 
                        value: "D_n=\\begin{vmatrix} 2 & 1 & 0 & \\cdots & 0 & 0\\\\ 1 & 2 & 1 & \\cdots & 0 & 0\\\\ 0 & 1 & 2 & \\ddots & \\vdots & \\vdots\\\\ \\vdots & \\vdots & \\ddots & \\ddots & 1 & 0\\\\ 0 & 0 & \\cdots & 1 & 2 & 1\\\\ 0 & 0 & \\cdots & 0 & 1 & 2 \\end{vmatrix}." 
                    },
                    { type: 'text', value: "Desarrollo por la primera fila:" },
                    { 
                        type: 'math', 
                        value: "D_n=2\\,D_{n-1}-1\\cdot M_{1,2}," 
                    },
                    { type: 'text', value: "donde \\(D_{n-1}\\) es el determinante que se obtiene eliminando la primera fila y la primera columna, y \\(M_{1,2}\\) es el menor que se obtiene eliminando la primera fila y la segunda columna:" },
                    { 
                        type: 'math', 
                        value: "M_{1,2}=\\begin{vmatrix} 1 & 1 & 0 & \\cdots & 0\\\\ 0 & 2 & 1 & \\ddots & \\vdots\\\\ \\vdots & \\ddots & \\ddots & \\ddots & 1\\\\ 0 & \\cdots & 0 & 1 & 2 \\end{vmatrix}." 
                    },
                    { type: 'text', value: "Restamos a la primera fila la segunda:" },
                    { 
                        type: 'math', 
                        value: "\\text{F}_1\\leftarrow \\text{F}_1-\\text{F}_2\\quad\\Rightarrow\\quad\\begin{vmatrix} 1 & -1 & -1 & \\cdots & -1\\\\ 0 & 2 & 1 & \\ddots & \\vdots\\\\ \\vdots & \\ddots & \\ddots & \\ddots & 1\\\\ 0 & \\cdots & 0 & 1 & 2 \\end{vmatrix}." 
                    },
                    { type: 'text', value: "Ahora desarrollamos por la primera columna: el único elemento no nulo de esa columna es el \\(1\\) de la primera fila, y el menor correspondiente es precisamente el determinante tridiagonal de orden \\(n-2\\):" },
                    { 
                        type: 'math', 
                        value: "\\begin{vmatrix} 2 & 1 & 0 & \\cdots & 0\\\\ 1 & 2 & \\ddots & \\ddots & \\vdots\\\\ 0 & \\ddots & \\ddots & 1 & 0\\\\ \\vdots & \\ddots & 1 & 2 & 1\\\\ 0 & \\cdots & 0 & 1 & 2 \\end{vmatrix}= D_{n-2}." 
                    },
                    { type: 'text', value: "Por tanto," },
                    { 
                        type: 'math', 
                        value: "M_{1,2}=D_{n-2}\\quad\\text{y}\\quad D_n=2D_{n-1}-D_{n-2},\\qquad n\\ge 3." 
                    }
                ]
            },
            {
                id: 3,
                title: "Demostración por inducción: \\(D_n=n+1\\)",
                content: [
                    { type: 'text', value: "<strong>Base de inducción:</strong>" },
                    { 
                        type: 'math', 
                        value: "D_1=2=1+1,\\qquad D_2=3=2+1." 
                    },
                    { type: 'text', value: "<strong>Paso inductivo:</strong> Supongamos cierto que" },
                    { 
                        type: 'math', 
                        value: "D_{n-1}=n,\\qquad D_{n-2}=n-1." 
                    },
                    { type: 'text', value: "Entonces, usando la recurrencia:" },
                    { 
                        type: 'math', 
                        value: "D_n=2D_{n-1}-D_{n-2}=2n-(n-1)=n+1." 
                    },
                    { type: 'text', value: "Por inducción completa," },
                    { 
                        type: 'math', 
                        value: "\\boxed{D_n=n+1\\quad\\text{para todo }n\\in\\mathbb{N}.}" 
                    }
                ]
            },
            {
                id: 4,
                title: "Reescritura del límite",
                content: [
                    { type: 'text', value: "Sustituimos \\(D_k=k+1\\) en el límite:" },
                    { 
                        type: 'math', 
                        value: "\\frac{D_1^2+\\cdots +D_n^2}{n^3}=\\frac{2^2+3^2+\\cdots +(n+1)^2}{n^3}." 
                    },
                    { type: 'text', value: "Definimos las sucesiones" },
                    { 
                        type: 'math', 
                        value: "a_n=2^2+3^2+\\cdots +(n+1)^2,\\qquad b_n=n^3." 
                    },
                    { type: 'text', value: "Nuestro límite es \\(\\displaystyle\\lim_{n\\to\\infty}\\frac{a_n}{b_n}\\)." },
                    { 
                        type: 'box', 
                        title: "Criterio de Stolz–Cesàro para cocientes", 
                        content: "Sean \\((a_n)\\) y \\((b_n)\\) sucesiones reales tales que: <ul><li>\\(b_n\\) es estrictamente creciente y \\(b_n\\to +\\infty\\).</li><li>Existe el límite \\[\\lim_{n\\to\\infty}\\frac{a_{n+1}-a_n}{b_{n+1}-b_n}=L\\in\\mathbb{R}\\cup\\{\\pm\\infty\\}.\\]</li></ul><p>Entonces existe \\[\\lim_{n\\to\\infty}\\frac{a_n}{b_n}\\quad\\text{y vale el mismo valor }L.\\]</p><p>Este criterio es especialmente útil cuando \\(\\dfrac{a_n}{b_n}\\) es difícil de tratar directamente, pero las diferencias \\(a_{n+1}-a_n\\) y \\(b_{n+1}-b_n\\) se simplifican mucho (por ejemplo, cuando \\(a_n\\) es una suma parcial).</p>"
                    },
                    { type: 'text', value: "En nuestro caso, \\(b_n=n^3\\) es estrictamente creciente y \\(b_n\\to +\\infty\\), luego podemos aplicar Stolz–Cesàro." }
                ]
            },
            {
                id: 5,
                title: "Aplicación del criterio de Stolz–Cesàro",
                content: [
                    { type: 'text', value: "Calculamos primero las diferencias:" },
                    { 
                        type: 'math', 
                        value: "a_{n+1}=2^2+3^2+\\cdots +(n+1)^2+(n+2)^2," 
                    },
                    { type: 'text', value: "por lo que" },
                    { 
                        type: 'math', 
                        value: "a_{n+1}-a_n=(n+2)^2." 
                    },
                    { type: 'text', value: "Por otra parte," },
                    { 
                        type: 'math', 
                        value: "b_{n+1}-b_n=(n+1)^3-n^3=3n^2+3n+1." 
                    },
                    { type: 'text', value: "El criterio de Stolz–Cesàro nos da:" },
                    { 
                        type: 'math', 
                        value: "\\lim_{n\\to\\infty}\\frac{a_n}{b_n}=\\lim_{n\\to\\infty}\\frac{a_{n+1}-a_n}{b_{n+1}-b_n}=\\lim_{n\\to\\infty}\\frac{(n+2)^2}{3n^2+3n+1}." 
                    },
                    { type: 'text', value: "Dividimos numerador y denominador por \\(n^2\\):" },
                    { 
                        type: 'math', 
                        value: "\\lim_{n\\to\\infty}\\frac{(n+2)^2}{3n^2+3n+1}=\\lim_{n\\to\\infty}\\frac{1+\\dfrac{4}{n}+\\dfrac{4}{n^2}}{3+\\dfrac{3}{n}+\\dfrac{1}{n^2}}=\\frac{1}{3}." 
                    }
                ]
            },
            {
                id: 6,
                title: "Conclusión",
                content: [
                    { type: 'text', value: "Por tanto," },
                    { type: 'conclusion', value: "\\lim_{n\\to\\infty}\\frac{D_1^2+D_2^2+\\cdots +D_n^2}{n^3}=\\frac{1}{3}." }
                ]
            }
        ];

        // DOM elements
        const leftColumn = document.getElementById('left-column');
        const rightColumn = document.getElementById('right-column');
        const zoomOverlay = document.getElementById('zoom-overlay');
        const zoomTitle = document.getElementById('zoom-title');
        const zoomBody = document.getElementById('zoom-body');
        const closeZoom = document.getElementById('close-zoom');

        // Create step element
        function createStepElement(step) {
            const stepDiv = document.createElement('div');
            stepDiv.className = 'step';
            stepDiv.id = `step-${step.id}`;
            stepDiv.dataset.stepId = step.id;
            
            let html = '';
            
            if (step.title) {
                html += `<div class="step-title">${step.title}</div>`;
            }
            
            html += '<div class="step-content">';
            
            step.content.forEach(item => {
                if (item.type === 'math') {
                    html += `<div class="math-block">\\[${item.value}\\]</div>`;
                } else if (item.type === 'conclusion') {
                    html += `<div class="conclusion-box">\\[\\boxed{${item.value}}\\]</div>`;
                } else if (item.type === 'box') {
                    html += `<div class="mybox"><h4>${item.title}</h4><p>${item.content}</p></div>`;
                } else {
                    html += `<p>${item.value}</p>`;
                }
            });
            
            html += '</div>';
            
            // Add zoom button
            html += `<button class="zoom-btn" onclick="zoomStep(${step.id})">+</button>`;
            
            stepDiv.innerHTML = html;
            return stepDiv;
        }

        // Render steps
        function renderSteps() {
            // Clear containers
            leftColumn.innerHTML = '';
            rightColumn.innerHTML = '';
            
            // First 4 steps (0-3) in left column
            for (let i = 0; i < 4; i++) {
                const stepElement = createStepElement(steps[i]);
                stepElement.style.display = 'none';
                leftColumn.appendChild(stepElement);
            }
            
            // Remaining steps (4-6) in right column
            for (let i = 4; i < steps.length; i++) {
                const stepElement = createStepElement(steps[i]);
                stepElement.style.display = 'none';
                rightColumn.appendChild(stepElement);
            }
        }

        // Current step tracking
        let currentStep = 0;

        // Show next step
        function showNextStep() {
            if (currentStep >= steps.length) return;
            
            const stepId = currentStep;
            const stepElement = document.getElementById(`step-${stepId}`);
            
            if (stepElement) {
                // Show the step
                stepElement.style.display = 'block';
                stepElement.classList.add('new');
                
                // Scroll to the step smoothly
                stepElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // After 3 seconds, remove the 'new' class
                setTimeout(() => {
                    if (stepElement.classList.contains('new')) {
                        stepElement.classList.remove('new');
                    }
                }, 3000);
                
                currentStep++;
            }
        }

        // Zoom functionality
        function zoomStep(stepId) {
            const step = steps.find(s => s.id === stepId);
            if (!step) return;
            
            // Set title
            zoomTitle.textContent = step.title ? `Paso ${stepId + 1}: ${step.title}` : `Paso ${stepId + 1}`;
            
            // Build content
            let html = '<div class="step zoomed-step">';
            if (step.title) {
                html += `<div class="step-title">${step.title}</div>`;
            }
            html += '<div class="step-content">';
            
            step.content.forEach(item => {
                if (item.type === 'math') {
                    html += `<div class="math-block">\\[${item.value}\\]</div>`;
                } else if (item.type === 'conclusion') {
                    html += `<div class="conclusion-box">\\[\\boxed{${item.value}}\\]</div>`;
                } else if (item.type === 'box') {
                    html += `<div class="mybox"><h4>${item.title}</h4><p>${item.content}</p></div>`;
                } else {
                    html += `<p>${item.value}</p>`;
                }
            });
            
            html += '</div></div>';
            
            zoomBody.innerHTML = html;
            
            // Show overlay
            zoomOverlay.classList.add('active');
            
            // Force MathJax to process the newly added content
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
        }

        // Close zoom
        closeZoom.addEventListener('click', () => {
            zoomOverlay.classList.remove('active');
        });

        // Close zoom when clicking outside content
        zoomOverlay.addEventListener('click', (e) => {
            if (e.target === zoomOverlay) {
                zoomOverlay.classList.remove('active');
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            renderSteps();
            
            // Show first step after a brief delay
            setTimeout(showNextStep, 500);
            
            // Click anywhere to advance
            document.addEventListener('click', function(e) {
                // Don't advance if clicking zoom button or close button
                if (e.target.classList.contains('zoom-btn') || 
                    e.target.id === 'close-zoom' || 
                    e.target.closest('#zoom-overlay')) {
                    return;
                }
                showNextStep();
            });
            
            // Initialize MathJax processing
            if (window.MathJax) {
                MathJax.typesetPromise();
            }
            
            // Force scrollbars to appear
            setTimeout(() => {
                // Ensure containers have enough height to trigger scrollbars
                const minHeight = Math.max(
                    window.innerHeight * 0.6,
                    leftColumn.scrollHeight,
                    rightColumn.scrollHeight
                );
                document.querySelectorAll('.steps-container').forEach(el => {
                    el.style.minHeight = minHeight + 'px';
                });
                
                // Force horizontal scrollbars to be visible by adding wide content
                const wideElements = document.querySelectorAll('.math-block, .mybox');
                wideElements.forEach(el => {
                    el.style.minWidth = '100%';
                });
            }, 100);
        });
    </script>
</body>
</html>

